<div class="container-fluid">
    <div class="d-flex align-items-center mt-2">
        <div class="m-2">
            <div class="h-size"><em class="fa fa-user mr-1"></em> <strong>List of Candidates</strong></div>
        </div>
        <div class="flex-fill">
        </div>
        <div class="m-3"><input class="form-control rounded-pill py-2 border-right-0 border" type="search"
                placeholder="search" id="example-search-input">
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <table class="table table-bordered table-hover table-sm">
                <thead class="t-head">
                    <tr>
                        <th *ngFor="let head of headers" id="headers1"><a>{{head}}</a></th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let candidate of candidateData">
                        <td>{{candidate.candidetId}}</td>
                        <td>{{candidate.candidetName}}</td>
                        <td>{{candidate.phonenumber}}</td>
                        <td>{{candidate.emailId}}</td>
                        <td> <a title="View JD" (click)="viewJD(candidate.jobId)"
                                class="icon-margin edit">{{candidate.jobId}}
                            </a>
                        </td>
                        <td>
                            <span *ngIf="!editStatusbtn">{{candidate.candidetStatus}}</span>
                            <select *ngIf="editStatusbtn" class="form-control form-control-sm" id="candidateStatus"
                                [(ngModel)]="candidate.candidetStatus"
                                [disabled]="candidate.candidetStatus == 'Offer Accepted'">
                                <option [value]="candidate.candidetStatus" selected disabled>
                                    {{candidate.candidetStatus}}</option>
                                <option *ngFor="let status of candidateStatuses" [value]="status">{{status}}</option>
                            </select>
                        </td>
                        <td>
                            <span *ngIf="!editStatusbtn">{{candidate.joiningDate | date:"dd-MM-yyyy" }}</span>
                            <!-- <input type="date" *ngIf="editStatusbtn"  [(ngModel)]="candidate.joiningDate"> -->
                            <input title="Will be enabled if the candidate has accepted Offer Letter"
                                *ngIf="editStatusbtn" type="text" bsDatepicker placeholder="Please Select Date"
                                [minDate]="toDay" (bsValueChange)="onStartDateValueChange($event)" readonly
                                [bsConfig]="{ isAnimated: true, dateInputFormat: 'DD-MM-YYYY' }" bsDatepicker
                                placement="bottom" class="text form-control" maxlength="50"
                                [disabled]="candidate.candidetStatus != 'Offer Accepted'"
                                [(ngModel)]="candidate.joiningDate" />

                        </td>

                        <td>
                            <a title="Edit" class="icon-margin" (click)="editCandidate(candidate)" data-toggle="modal"
                                data-target="#myModal-add"><em class="fas fa-user-edit"></em></a>
                            <a title="Delete" class="icon-margin" (click)="removeCandidate(candidate.candidetId)"
                                data-toggle="modal" data-target="#confirmDelete"><span class="fas fa-trash"></span></a>
                        </td>
                    </tr>
                </tbody>

            </table>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <button type="button" class="btn btn-primary btn-sm" data-toggle="modal" (click)="addClick()"
                data-target="#myModal-add" *ngIf="!editStatusbtn">
                <em class="fas fa-user-plus"></em> Add
            </button>&nbsp;
            <button id="w3" class="btn btn-primary btn-sm" data-target="#exampleModal" (click)="clickImport()"
                data-toggle="modal" title="Import">
                <i class="glyphicon glyphicon-import"></i> Import
            </button>
            <!-- <button type="button" class="btn btn-primary btn-sm"
                title="Click here to edit multiple candidate statuses and save the joining date" *ngIf="!editStatusbtn"
                (click)="editStatus()">
                <em class="fa fa-pencil-square"></em> Edit Status
            </button>&nbsp; -->
            <!-- <button type="button" class="btn btn-primary btn-sm" *ngIf="editStatusbtn"
                (click)="updateMultipleStatuses()">
                <em class="fa fa-pencil-square"></em> Update
            </button>&nbsp;

            <button type="button" class="btn btn-primary btn-sm" *ngIf="editStatusbtn"
                (click)="cancelUpdateMultipleStatuses()">
                <em class="fa fa-ban"></em> Cancel
            </button>&nbsp; -->
        </div>
    </div>
</div>
<div class="modal fade common-model" id="myModal-add">
    <div class="modal-dialog modal-lg">
        <div class="modal-content model">
            <!-- Modal Header -->
            <div class="modal-header">
                <div class="modal-title"><i class="fas fa-plus"></i>/ <i class="fas fa-edit ml-1"></i> Candidate Details
                </div>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <!-- <div class="alert alert-success success-alert" *ngIf="saveAlert">
                <h4><i class="icon fa fa-check"></i> Success!</h4>
                Record has been Saved successfully.
            </div>
            <div class="alert alert-success success-alert" *ngIf="updateAlert">
                <h4><i class="icon fa fa-check"></i> Success!</h4>
                Record has been Updated successfully.
            </div> -->
            <!-- Modal body -->
            <div class="modal-body">
                <div>
                    <form [formGroup]="CandidatesForm">
                        <div class="row col-12 padding-field-bottom">
                            <div class="col-6">
                                <label>Candidate Name <span class="color-red">* </span></label>
                                <input type="text" class="form-control" placeholder="Please Enter Candidate Name"
                                    formControlName="candidetName">
                                <span class="color-red" *ngIf="submitted && form_.candidetName.errors">Candidate Name
                                    {{requiredErrorText}}</span>
                            </div>
                            <div class="col-6">
                                <label>Phone Number <span class="color-red">* </span></label>
                                <input type="text" class="form-control" placeholder="Please Phone Numbert"
                                    formControlName="phonenumber">
                                <span class="color-red" *ngIf="submitted && form_.phonenumber.errors">Phone Number
                                    {{requiredErrorText}}</span>
                            </div>
                        </div>
                        <div class="row col-12 padding-field-bottom">
                            <div class="col-6">
                                <label>Email Id <span class="color-red">* </span></label>
                                <input type="text" class="form-control" placeholder="Please enter Email Id"
                                    formControlName="emailId" (change)="checkIfEmailExists($event)"
                                    [ngClass]="{ 'is-invalid': submitted && form_.emailId.errors }">
                                <span class="color-red" *ngIf="submitted && form_.emailId.errors">Email
                                    {{requiredErrorText}}</span>
                                <span class="color-red" *ngIf="emailExists">Email
                                    Already Exist</span>
                            </div>
                            <div class="col-6">
                                <label>JD Id <span class="color-red">* </span></label>
                                <select formControlName="jobId" class="custom-select-box form-control"
                                    [ngClass]="{ 'is-invalid': submitted && form_.jobId.errors }">
                                    <option value="" disabled>Please Select JD Id</option>
                                    <option *ngFor="let jd of jdIdData" [value]="jd.jobId">
                                        {{jd.jobId}}-{{jd.resourceTitle}}
                                    </option>
                                </select>
                                <span class="color-red" *ngIf="submitted && form_.jobId.errors">JD Id
                                    {{requiredErrorText}}</span>
                            </div>
                        </div>
                        <div class="row col-12 padding-field-bottom">
                            <div class="col-6" *ngIf="!hideStatusWhileEditing">
                                <label>Status <span class="color-red">* </span></label>
                                <select formControlName="candidetStatus" class="custom-select-box form-control"
                                    [ngClass]="{ 'is-invalid': submitted && form_.candidetStatus.errors }">
                                    <option value="" disabled>Please Select Status</option>
                                    <option *ngFor="let status of candidateStatuses" [value]="status">{{status}}
                                    </option>
                                </select>
                                <span class="color-red" *ngIf="submitted && form_.candidetStatus.errors">Status
                                    {{requiredErrorText}}</span>
                            </div>
                            <div class="col-6">
                                <label style="margin-bottom: 0px;">Referenced By <span class="color-red">*&nbsp;&nbsp;
                                    </span>
                                    <span><input id="deny" class="radio-size" name="referencedType" type="radio"
                                            value="External" formControlName="referencedType"
                                            (ngModelChange)="handleReferencedType('External')">
                                        <label>&nbsp;External</label></span>&nbsp;
                                    <span><input id="approve" class="radio-size" name="referencedType" type="radio"
                                            value="Internal" formControlName="referencedType"
                                            (ngModelChange)="handleReferencedType('Internal')">
                                        <label>&nbsp;Internal</label></span>
                                </label>
                                <input *ngIf="showExternal" type="text" class="form-control"
                                    placeholder="Please Enter Person Name" formControlName="referencedPersonName">
                                <!-- <ng-multiselect-dropdown *ngIf="!showExternal" [placeholder]="'Please Select Department'"
                                    [settings]="dropdownSettings" [data]="employeeList"
                                     (onSelect)="onItemSelect($event)"
                                    (onSelectAll)="onSelectAll($event)" (onDeSelectAll)="onDeSelectAll($event)"
                                    (onDeSelect)="onItemDeSelect($event)">
                                </ng-multiselect-dropdown> -->
                                <select *ngIf="!showExternal" formControlName="referencedPersonName"
                                    class="custom-select-box form-control"
                                    [ngClass]="{ 'is-invalid': submitted && form_.referencedPersonName.errors }">
                                    <option value="" disabled>Please Select Person Name</option>
                                    <option *ngFor="let emp of employeeList" [value]="emp.employeeId">
                                        {{emp.employeeCode}} - {{emp.firstName}} {{emp.lastName}}
                                    </option>
                                </select>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-md-6 pull-left">
                                <button type="button" class="button btn-primary btn-style" *ngIf="togglebtn"
                                    [disabled]="submitProcessing" (click)="onSubmit()">Save <i
                                        class="fa fa-spinner fa-spin" *ngIf="submitProcessing"
                                        style="font-size:19px"></i></button>
                                <button type="button" class="button btn-primary btn-style" *ngIf="!togglebtn"
                                    [disabled]="submitProcessing" (click)="updateReferalRecruitment()">Update <i
                                        class="fa fa-spinner fa-spin" *ngIf="submitProcessing"
                                        style="font-size:19px"></i></button>
                            </div>
                            <div class="col-md-6 pull-right" *ngIf="togglebtn">
                                <button type="button" id="btnComponentSave" (click)="clear()"
                                    class="button btn-warning btn-style" [disabled]="submitProcessing">
                                    Clear</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade common-model" id="view-jd">
    <div class="modal-dialog modal-xl">
        <div class="modal-content model width">
            <!-- Modal Header -->
            <div class="modal-header">
                <div class="modal-title"><i class="fa fa-eye" aria-hidden="true"></i> View JD
                </div>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <!-- Modal body -->
            <div class="modal-body sample">
                <div>
                    <div class="row col-12 padding-field-bottom">
                        <div class="col-2">
                            <label>Resource Title :</label>
                        </div>
                        <div class="col-10">
                            {{newResourceIndent.resourceTitle}}
                        </div>

                    </div>
                    <div class="row col-12 padding-field-bottom">
                        <div class="col-2">
                            <label>For which project :</label>
                        </div>
                        <div class="col-10" *ngIf="newResourceIndent.project == null">
                            -
                        </div>
                        <div class="col-10" *ngIf="newResourceIndent.project != null">
                            {{newResourceIndent.project.projectName}}
                        </div>
                    </div>
                    <div class="row col-12 padding-field-bottom">
                        <div class="col-2">
                            <label>Number Required :</label>
                        </div>
                        <div class="col-10">
                            {{newResourceIndent.numberRequired}}
                        </div>
                    </div>
                    <div class="row col-12 padding-field-bottom">
                        <div class="col-2">
                            <label>Request Reason :</label>
                        </div>
                        <div class="col-10">
                            {{newResourceIndent.requestReason}}
                        </div>
                    </div>

                    <div class="row col-12 padding-field-bottom">
                        <div class="col-2">
                            <label>Hiring Start Date :</label>
                        </div>
                        <div class="col-10">
                            {{newResourceIndent.hiringStartDate}}
                        </div>
                    </div>
                    <div class="row col-12 padding-field-bottom">
                        <div class="col-2">
                            <label>Job Description :</label>
                        </div>
                        <div class="col-10 align-justify">{{newResourceIndent.jobDescription}}</div>
                    </div>
                    <div class="row col-12 padding-field-bottom">
                        <div class="col-2">
                            <label>Attachment :</label>
                        </div>
                        <div class="col-10">
                            <a title="Download to View" class="icon-margin"
                                (click)="downloadDocumentAttachment(newResourceIndent.filePath, newResourceIndent.fileName)"
                                target="_blank"><em class="fas fa-download"></em></a>
                            {{newResourceIndent.fileName}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="confirmDelete" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-body"><button type="button" class="close" data-dismiss="modal">&times;</button>
                <p>Are you sure you want to delete selected items?</p>
            </div>
            <div class="modal-footer" style="justify-content: flex-end;">
                <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">Close</button>
                <button type="button" data-dismiss="modal" class="btn btn-primary btn-sm"
                    (click)="deleteCandidate()">Ok</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="exampleModal" role="dialog">
    <div class="modal-dialog modal-xl">
        <div class="modal-content model width">
            <div class="modal-header">
                <span style="font-size: 20px;">
                    <i class="fa fa-upload"></i> Import Candidate(s)
                </span>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <section class="content">
                    <form id="import-student">
                        <div class="box box-primary">
                            <div class="box-header with-border">
                                <h3 class="box-title"><i class="fa fa-file-excel-o"></i> Select File</h3>
                            </div>
                            <!--./box-header-->
                            <div class="box-body">
                                <div class="row">
                                    <div class="col-sm-4">
                                        <div class="form-group field-stumaster-importfile">
                                            <input type="file" id="stumaster-importfile" (change)="importFile($event)"
                                                [(ngModel)]="importFileModel" #inputFile name="importFile"
                                                title="Browse Excel File" accept=".xlsx, .xls">
                                            <div class="help-block"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="callout callout-info" style="background-color:#d0e5f9 !important">
                                            <h4>Please follow these instructions at the time of importing data.</h4>
                                            <ol>
                                                <li><b>The fields with red color are required and cannot be blank.</b>
                                                </li>
                                                <li>Status should be <b>Screening & Evaluation</b></li>
                                                <li>Referenced By should be <b>External/Internal</b></li>
                                                <li>If Referenced By is <b>Internal</b> then Person name should be belongs to Employee Master and should be First name and Last name(Ex - John Smith)</li>
                                                <li>Leaving mandatory fields might have effect on consecutive records.
                                                </li>
                                            </ol>
                                            <h4>Download the sample Excel sheet format. <b><a
                                                        href="./assets/excel/referral_recruitment_import.xlsx"
                                                        target="_blank"><i class="fa fa-download"
                                                            aria-hidden="true"></i>
                                                        Download</a></b></h4>
                                        </div>
                                        <!--./callout-->
                                    </div>
                                    <!--./col-->
                                </div>
                                <!--./row-->
                            </div>
                            <!--./box-body-->
                            <div class="box-footer">
                                <button type="submit" (click)="submit()" class="btn btn-primary"
                                    [disabled]="disableImport"><i class="fa fa-upload"></i> {{importText}}</button>
                            </div>
                        </div>
                        <!--./box-->
                    </form>
                    <div class="box box-solid">
                        <br>
                        <div class="box-header with-border">
                            <h3 class="box-title"><i class="fa fa-list"></i> Import Candidate(s) Result</h3>
                        </div>
                        <div *ngIf="showSuccessMsg" class="alert alert-success alert-dismissable flash-msg-hide">
                            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
                            <h4><i class="icon fa fa-check"></i> Imported!</h4> {{successCount}} Candidate(s) imported
                            successfully.
                        </div>
                        <div *ngIf="showErrorMsg" class="alert alert-danger alert-dismissable flash-msg-hide">
                            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
                            <h4><i class="icon fa fa-check"></i> Error!</h4> {{errorCount}} Candidate(s) importing
                            error.
                        </div>
                        <div class="box-body table-responsive table-wrapper-scroll-y table-wrapper-scroll-x"
                            style="max-height: 300px;">
                            <div id="w1">
                                <div id="w2" class="grid-view">
                                    <table class="table table-striped table-borders myTable">
                                        <thead>
                                            <tr>
                                                <th>Sr No</th>
                                                <th>Candidate Name</th>
                                                <th>Phone Number</th>
                                                <th>Email Id</th>
                                                <th>JD Id</th>
                                                <th>Status</th>
                                                <th>Referenced By</th>
                                                <th>Person Name</th>
                                                <th>Alert</th>
                                                <th>Remarks/Message(s)</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngIf='importResult.length == 0 && !toggleLoader'>
                                                <td colspan="11">
                                                    <div class="empty">No Records Found.</div>
                                                </td>
                                            </tr>
                                            <ng-container *ngFor="let data of importResult;let i=index;">
                                                <tr>
                                                    <td>{{i+1}}</td>
                                                    <td>{{data.candiates.candidetName}}</td>
                                                    <td>{{data.candiates.phonenumber}}</td>
                                                    <td>{{data.candiates.emailId}}</td>
                                                    <td> <a title="View JD" (click)="viewJD(data.candiates.resourceIndentRequest.jobId)"
                                                            class="icon-margin edit">{{data.candiates.resourceIndentRequest.jobId}}
                                                        </a>
                                                    </td>
                                                    <td>{{data.candiates.candidetStatus}}</td>
                                                    <td>{{data.candiates.referencedType}}</td>
                                                    <td>{{data.candiates.referencedPersonName}}</td>
                                                    <td><span *ngIf="data.errors.length != 0">ERROR</span> <span
                                                            *ngIf="data.errors.length == 0">SUCCESS</span></td>
                                                    <td [class.success]="data.errors.length == 0">
                                                        <ng-container *ngIf="data.errors.length != 0">
                                                            Please fix the following errors:
                                                            <ul *ngFor="let error of data.errors">
                                                                <li style="color: red;"> {{error}}</li>
                                                            </ul>
                                                        </ng-container>
                                                    </td>
                                                </tr>
                                            </ng-container>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            </div>
        </div>
    </div>
</div>