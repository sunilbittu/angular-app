<div class="container-fluid">
    <div class="d-flex align-items-center mt-2">
        <div class="m-2">
            <div class="h-size"><em class="fa fa-user"></em> <strong> Clients Report</strong></div>
        </div>
        <div class="flex-fill"></div>
        <div class="m-2"></div>
        <div class="m-3"></div>
    </div>
    <div class="row">
        <div class="form-group col-md-4">
            <label for="stage">Stage <span class="color-red"></span></label>
            <ng-multiselect-dropdown [placeholder]="'Select Stage'" [settings]="dropdownSettingsStage"
                [data]="stageList" [(ngModel)]="selectedItemsStage" (onSelect)="onItemSelectStage($event)"
                (onDeSelect)="OnStageItemDeSelect($event)" (onSelectAll)="onSelectAllStage($event)">
            </ng-multiselect-dropdown>
        </div>
        <div class="form-group col-md-4">
            <label for="contract">Contract Type <span class="color-red"></span></label>
            <select id="contract" [(ngModel)]="contarctModel" name="contract" class="form-control height"
                name="contract">
                <option value=null disabled>Please Select Type</option>
                <option *ngFor="let data of contractType" [value]="data">
                    {{data}}
                </option>
            </select>
        </div>
        <div class="form-group col-md-4">
            <label for="user">Client Owner <span class="color-red"></span></label>
            <ng-multiselect-dropdown [placeholder]="'Select Client Owner'" [settings]="dropdownSettingsTeam"
                [data]="employeeList" [(ngModel)]="selectedItemsTeam" (onSelect)="onItemSelectTeam($event)"
                (onDeSelect)="OnTeamItemDeSelect($event)" (onSelectAll)="onSelectAllTeam($event)">
            </ng-multiselect-dropdown>
        </div>
        <div class="form-group col-md-4">
            <label>Created Start Date</label>
            <input type="text" [(ngModel)]="startDate" bsDatepicker placeholder="Please Select Start Date" readonly
                [bsConfig]="{ isAnimated: true, dateInputFormat: 'DD-MM-YYYY' }" bsDatepicker
                (bsValueChange)="onStartDateValueChange($event)" placement="bottom"
                class="text form-control pull-top-5 read-only" maxlength="50" />
        </div>
        <div class="form-group col-md-4">
            <label>Created End Date</label>
            <input type="text" [(ngModel)]="endDate" bsDatepicker placeholder="Please Select End Date"
                [minDate]="selectedStartDate" readonly [bsConfig]="{ isAnimated: true, dateInputFormat: 'DD-MM-YYYY' }"
                bsDatepicker (bsValueChange)="onEndDateValueChange($event)" placement="bottom"
                class="text form-control pull-top-5 read-only" maxlength="50" />
        </div>
        <div class="form-group col-md-4 padding-top-25">
            <button type="button" id="search" class="btn btn-primary btn-sm" (click)="searchFilter()">Search</button>
            &nbsp;
            <button type="button" id="search" class="btn btn-warning btn-sm" (click)="clear()">Clear</button>
            &nbsp;&nbsp;
            <button title="Export" class="btn btn-primary btn-sm" mat-icon-button [matMenuTriggerFor]="menu"
                aria-label="Menu">
                <i class='fas fa-file-export'></i> Export
            </button>
            <mat-menu #menu="matMenu">
                <button mat-menu-item type="button" class="btn btn-labeled btn-sm" (click)="exportTable('PDF')">
                    <span class="btn-label"><i class="fa fa-file-pdf-o" aria-hidden="true"></i></span> Export To
                    PDF</button>
                <button mat-menu-item type="button" class="btn btn-labeled btn-sm" (click)="exportTable('EXCEL')">
                    <span class="btn-label"><i class="fa fa-file-excel-o" aria-hidden="true"></i></span> Export To
                    Excel</button>
            </mat-menu>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <div class="table-responsive">
            <table sortable-table (sorted)="onSorted($event)" class="table table-bordered table-hover table-sm">
                <thead class="t-head">
                    <tr>
                        <!-- <th *ngFor="let head of headers"><a>{{head}}</a></th> -->
                        <th sortable-column="clientName"><a>Client Name</a></th>
                        <th sortable-column="clientName"><a>Client Website</a></th>
                        <th sortable-column="clientName"><a>Client Industry</a></th>
                        <th sortable-column="clientName"><a>Client Location</a></th>
                        <th sortable-column="clientName"><a>Client Address</a></th>
                        <th sortable-column="clientName"><a>Client Created Date</a></th>
                        <th sortable-column="clientName"><a>Job Count</a></th>
                        <th sortable-column="clientName"><a>Client Owner</a></th>
                        <th sortable-column="clientName"><a>Client Team</a></th>
                        <th sortable-column="clientName"><a>Client Stage</a></th>
                        <th sortable-column="clientName"><a>Contract Type</a></th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngIf='clientList && clientList.length == 0'>
                        <td colspan="11">
                            <div class="align-center">No Records Found.</div>
                        </td>
                    </tr>
                    <tr
                        *ngFor="let data of clientList | paginate: { itemsPerPage: numberOfEntitesToShow, currentPage: p } ; let i=index;">
                        <td><a class="advance">{{data.clientName | uppercase}}</a></td>
                        <td>{{data.clientWebsite}}</td>
                        <td>{{data.clientIndustry}}</td>
                        <td>{{data.clientLocation}}</td>
                        <td>{{data.clientAddress}}</td>
                        <td>{{data.createdDate | date:'dd-MM-yyyy'}}</td>
                        <td>{{data.jobCount}}</td>
                        <td>{{data.clientOwner}}</td>
                        <td><a title="View Team members" data-toggle="modal" data-target="#show-team-member-modal"
                                (click)="showTeamMembers(data.id)" class="icon-margin"><i class="fas fa-eye"></i></a>
                        </td>
                        <td>{{data.clientStage}}</td>
                        <td>{{data.contractType}}</td>
                    </tr>
                </tbody>
            </table>
            </div>
            <div class="row">
                <div class="col-md-6 col-sm-6 col-6"><span class="show-entry">Showing
                    <span>{{showingFrom}} to {{showingTo}} of {{totalElements}} entries</span></span>&nbsp;
                </div>
                <div class="col-md-6" *ngIf="clientList.length > 0">
                    <pagination-controls (pageChange)="onPageChange($event)"></pagination-controls>
                </div>
            </div>
            <!-- <div class="row">
                <div class="col-md-6" *ngIf="clientList > 0">
                    <pagination-controls (pageChange)="p = $event"></pagination-controls>
                </div>
            </div> -->
        </div>
    </div>
</div>
<div class="modal alert-modal fade" id="show-team-member-modal" role="dialog" style="display: none;">
    <div class="modal-dialog modal-md">
        <div class="modal-content model">
            <div class="modal-header " id="msg_header">
                <h4 class="modal-title">Team Members</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-12">
                        <table class="table table-striped table-bordered">
                            <thead class="t-head">
                                <tr>
                                    <th *ngFor="let head of teamMembersHeader"><a>{{head}}</a></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngIf='teamMembersList && teamMembersList.length == 0'>
                                    <td colspan="3">
                                        <div class="align-center">No Records Found.</div>
                                    </td>
                                </tr>
                                <tr *ngFor="let member of teamMembersList">
                                    <td>{{member.name}}</td>
                                    <td>{{member.displayName}}</td>
                                    <td>{{member.lastActive}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>