<div class="container-fluid">
    <div class="d-flex align-items-center mt-2">
        <div class="m-2">
            <div class="h-size"><i class="fa fa-user"></i> <b> Resource Recruitment Indent List</b></div>
        </div>
        <div class="flex-fill">
        </div>
        <div class="m-3"><input class="form-control rounded-pill py-2 border-right-0 border" type="search"
            placeholder="search" id="example-search-input" >
    </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <table class="table table-bordered table-hover table-sm">
                <thead class="t-head">
                    <tr>
                        <th class="action-width align-center"><a>#</a></th>
                        <th *ngFor="let head of headers"><a>{{head}}</a></th>
                        <th class="action-width align-center">Action</th>
                    </tr>
                </thead> 
                <tbody>
                    <tr *ngIf="toggleLoader">
                        <td colspan="8">
                            <img src="./assets/images/loader-icon.gif" class="loader-margin img-responsive"
                                alt="loading....">
                        </td>
                    </tr>
                    <tr *ngFor="let resource of resourceList; let i=index">
                        <td class="action-width align-center">{{i + 1}}</td>
                        <td>{{resource.resourceTitle}}</td>
                        <td>{{resource.numberRequired}}</td>
                        <td>{{resource.project.projectName}}</td>
                        <td style="width: 30%;">{{resource.jobDescription}}</td>
                        <td>{{resource.requestReason}}</td>
                        <td><a title="Download to View" class="icon-margin" target="_blank"
                                (click)="downloadDocumentAttachment(resource.filePath, resource.fileName)"><i
                                    class="fas fa-download"></i></a></td>
                        <td>{{resource.budgetApprovingAuthorityFirstName}} {{resource.budgetApprovingAuthorityLastName}}</td>
                        <td>{{resource.budgetApprovalAction}}</td>
                        <td> <span  *ngIf="resource.isOpen == true" >Open</span>
                             <span *ngIf="resource.isOpen == false">Closed</span>
                        </td>
                        <td class="action-width align-center">
                            <a  title="Edit" class="icon-margin edit"><i class="fas fa-user-edit"
                                    (click)="editResource(resource)"></i></a>
                            <a title="Delete" class="icon-margin" mwlConfirmationPopover [popoverTitle]="popoverTitle"
                                [popoverMessage]="popoverMessage" placement="left" (confirm)="delete(resource.jobId)"
                                (cancel)="cancelClicked = true"><span class="fas fa-trash"></span></a>
                        </td>
                    </tr>
                </tbody>

            </table>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <button id="btn_add" type="button" data-toggle="modal" data-target="#add-new-resourse"
                class="button btn-primary button" (click)="addResource()"><i class="fas fa-user-plus"></i> Add</button>
        </div>
    </div>
</div>

<div class="modal fade common-model" id="add-new-resourse">
    <div class="modal-dialog modal-xl">
        <div class="modal-content model">
            <!-- Modal Header -->
            <div class="modal-header">
                <div class="modal-title"><i class="fas fa-plus"></i>/ <i class="fas fa-edit ml-1"></i> Resource
                    Recruitment Indent
                </div>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="alert alert-success success-alert" *ngIf="saveAlert">
                <h4><i class="icon fa fa-check"></i> Success!</h4>
                Record has been Saved successfully.
            </div>
            <div class="alert alert-success success-alert" *ngIf="updateAlert">
                <h4><i class="icon fa fa-check"></i> Success!</h4>
                Record has been Updated successfully.
            </div>
            <!-- Modal body -->
            <div class="modal-body">
                <div>
                    <form [formGroup]="form" (ngSubmit)="submit()">
                        <div class="row col-12 padding-field-bottom">
                            <div class="col-2">
                                <label>Resource Title <span class="color-red">* </span></label>
                            </div>
                            <div class="col-4">
                                <input type="text" class="form-control" placeholder="Please Enter Resource Title"
                                    formControlName="resourceTitle"
                                    [ngClass]="{ 'is-invalid': submitted && form_.resourceTitle.errors }">
                                <span class="color-red" *ngIf="submitted && form_.resourceTitle.errors">Resource Title
                                    {{requiredErrorText}}</span>
                            </div>
                            <div class="col-2">
                                <label for="branch">Branch<span class="color-red">*</span></label>
                            </div>
                        
                            <div class="col-4">
                                <select id="branch" formControlName="Branch" class="form-control text"
                                (change)="fetchDepartmentList()" required>
                                <option value="" selected disabled hidden>--Select--</option>
                                <option *ngFor="let branch of branchList" [value]="branch.companyBranchDetailsId">
                                    {{branch.branchName}}
                                </option>
                            </select>
                            <span class="color-red" *ngIf="submitted && form_.Branch.errors">Branch
                                {{requiredErrorText}}</span>
                            </div>
                        </div>
                        <div class="row col-12 padding-field-bottom">
                            <div class="col-2">
                                <label>Number Required <span class="color-red">* </span></label>
                            </div>
                            <div class="col-4">
                                <select class="custom-select-box form-control" formControlName="numberRequired"
                                    [ngClass]="{ 'is-invalid': submitted && form_.numberRequired.errors }">
                                    <option value="" disabled>Please Select Number</option>
                                    <option *ngFor="let number of numberRequired" [value]="number">
                                        {{number}}
                                    </option>
                                </select>
                                <span class="color-red" *ngIf="submitted && form_.numberRequired.errors">Number Required
                                    {{requiredErrorText}}</span>
                            </div>
                            <div class="col-2">
                                <label for="department">Department<span class="color-red">*</span></label>
                            </div>
                           
                            <div class="col-4">
                                <select id="department" formControlName="Department" class="form-control text">
                                    <option value="" selected disabled hidden>--Select--</option>
                                    <option *ngFor="let department of departMentList" [value]=department.departmentId>
                                        {{department.departmentName}}
                                    </option>
                                </select>
                                <span class="color-red" *ngIf="submitted && form_.Department.errors">Department
                                    {{requiredErrorText}}</span>
                                
                            </div>
                        </div>
                        <div class="row col-12 padding-field-bottom">
                            <div class="col-2">
                                <label>Request Reason <span class="color-red">* </span></label>
                            </div>
                            <div class="col-4">
                                <select formControlName="requestReason" class="custom-select-box form-control"
                                    [ngClass]="{ 'is-invalid': submitted && form_.requestReason.errors }">
                                    <option value="" disabled>Please Select Reason</option>
                                    <option *ngFor="let reason of reasonList" [value]="reason">
                                        {{reason}}
                                    </option>
                                </select>
                                <span class="color-red" *ngIf="submitted && form_.requestReason.errors">Request Reason
                                    {{requiredErrorText}}</span>
                            </div>
                            <div class="col-2">
                                <label for="grade">Grade<span class="color-red">*</span></label>
                            </div>
                           
                            <div class="col-4">
                                <select id="grade" formControlName="Grade" class="form-control text" required>
                                    <option value="" selected disabled hidden>--Select--</option>
                                    <option *ngFor="let grade of gradeList" [value]=grade.gradeId>
                                        {{grade.gradeName}}
                                    </option>
                                </select>
                                <span class="color-red" *ngIf="submitted && form_.Grade.errors">Grade
                                    {{requiredErrorText}}</span>
                            </div>
                            
                        </div>

                        <div class="row col-12 padding-field-bottom">
                            <div class="col-2">
                                <label>By When <span class="color-red">* </span></label>
                            </div>
                            <div class="col-4">
                                <input type="text" formControlName="hiringStartDate" bsDatepicker
                                    placeholder="Please Select Date"
                                    [ngClass]="{ 'is-invalid': submitted && form.controls.hiringStartDate.errors }" [minDate]="toDay"
                                    readonly [bsConfig]="{ isAnimated: true, dateInputFormat: 'DD-MM-YYYY' }"
                                    bsDatepicker (bsValueChange)="onHiringStartDateValueChange($event)"
                                    placement="bottom" class="text form-control pull-top-5" maxlength="50" />
                                <span class="color-red" *ngIf="submitted && form_.hiringStartDate.errors">Hiring Start
                                    Date
                                    {{requiredErrorText}}</span>
                            </div>
                            <div class="col-2">
                                <label for="designation">Designation<span class="color-red">*</span></label>
                            </div>
                           
                            <div class="col-4">
                                <select id="designation" formControlName="Desiganion" class="form-control text">
                                    <option value="" selected disabled hidden>--Select--</option>
                                    <option *ngFor="let designation of designationList" [value]=designation.designationId>
                                        {{designation.designationName}}
                                    </option>
                                </select>
                                <span class="color-red" *ngIf="submitted && form_.Desiganion.errors">Desiganion
                                    {{requiredErrorText}}</span>
                                
                            </div>
                        </div>
                        <div class="row col-12 padding-field-bottom">
                            <div class="col-2">
                                <label>Request Date <span class="color-red">* </span></label>
                            </div>
                            <div class="col-4">
                                <input type="text" class="form-control" name="requestDate"
                                    placeholder="Please Select Date" value="{{tempReqDate}}" readonly>
                            </div>
                            <div class="col-2">
                                <label for="costCenteer">Cost Center<span class="color-red">*</span></label>
                            </div>
                           
                            <div class="col-4">
                                <select id="costCenteer" formControlName="CostCenter" class="form-control text">
                                    <option value="" selected disabled hidden>--Select--</option>
                                    <option *ngFor="let costcenter of costCenterList" [value]=costcenter.costCenterId>
                                        {{costcenter.costCenterName}}
                                    </option>
                                </select>
                                <span class="color-red" *ngIf="submitted && form_.CostCenter.errors">CostCenter
                                    {{requiredErrorText}}</span>
                            </div>
                        </div>
                        <div class="row col-12 padding-field-bottom">
                            <div class="col-2">
                                <label>Request Raised By <span class="color-red">* </span></label>
                            </div>
                            <div class="col-4">
                                <input type="text" class="form-control" formControlName="requestRaisedBy" readonly>
                            </div>
                            <div class="col-2">
                                <label for="category"> Category<span class="color-red">*</span></label>
                            </div>
                           
                            <div class="col-4">
                                <select id="category" formControlName="Category" class="form-control text">
                                    <option value="" selected disabled hidden>--Select--</option>
                                    <option *ngFor="let category of categoryList" [value]=category.categoryId>
                                        {{category.categoryName}}
                                    </option>
                                </select>
                                <span class="color-red" *ngIf="submitted && form_.Category.errors">Category
                                    {{requiredErrorText}}</span>
                            </div>
                           
                        </div>
                        <div class="row col-12 padding-field-bottom">
                            <div class="col-2">
                                <label>Budget Approving Authority <span class="color-red">* </span></label>
                            </div>
                            <div class="col-4">
                                <select formControlName="budgetApprovingAuthority"
                                    class="custom-select-box form-control"
                                    [ngClass]="{ 'is-invalid': submitted && form_.budgetApprovingAuthority.errors }">
                                    <option value="" disabled>Please Select Budget Approving Authority</option>
                                    <option *ngFor="let emp of employeeList" [value]="emp.employeeId">
                                        {{emp.employeeCode}} - {{emp.firstName}} {{emp.lastName}}
                                    </option>
                                </select>
                                <span class="color-red"
                                    *ngIf="submitted && form_.budgetApprovingAuthority.errors">Budget Approving
                                    Authority {{requiredErrorText}}</span>
                            </div>
                            <div class="col-2">
                                <label>For which project <span class="color-red">* </span></label>
                            </div>
                           
                            <div class="col-4">
                                <select id="project" formControlName="project" class="form-control text">
                                    <option value="" selected disabled hidden>--Select--</option>
                                    <option *ngFor="let project of projectList" [value]=project.projectId>
                                        {{project.projectName}}
                                    </option>
                                </select>
                                <span class="color-red" *ngIf="submitted && form_.project.errors">For which project
                                    {{requiredErrorText}}</span>
                            </div>
                           
                        </div>
                        <div class="row col-12 padding-field-bottom">
                            <div class="col-2">
                                <label>Add Attachment <span class="color-red">* </span></label>
                            </div>
                            <div class="col-4">
                                <input type="file" formControlName="selectedFile" class="form-control height-45" (change)="onFileChanged($event)">
                                <span class="color-red"
                                    *ngIf="submitted && (selectedFile == '' || selectedFile == undefined) && !fileSelected">Attachment
                                    {{requiredErrorText}}</span>
                            </div>
                            <div class="col-6" *ngIf="fileSelected">
                                <a title="Download to View" class="icon-margin" target="_blank" (click)="download()"><i
                                        class="fas fa-download"></i></a>
                                {{imageFileName}}
                            </div>
                        </div>
                     
                        <div class="row col-12 padding-field-bottom">
                            <div class="col-2">
                                <label>Job Description <span class="color-red">* </span></label>
                            </div>
                            <div class="col-10">
                                <textarea id="txtformula" rows="4" placeholder="Please Enter Job Description"
                                    class="form-control w-100" maxlength="2500" formControlName="jobDescription"
                                    [ngClass]="{ 'is-invalid': submitted && form_.jobDescription.errors }"></textarea>
                                <span class="color-red" *ngIf="submitted && form_.jobDescription.errors">Job Description
                                    {{requiredErrorText}}</span>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div  class="col-md-6 pull-left">
                                <button *ngIf="weathertoshowupdatebutton" type="submit" id="btnComponentSave" [disabled]="submitProcessing"
                                    class="button btn-primary btn-style"><i class="fas fa-save"></i>
                                    {{submitText}} <i class="fa fa-spinner fa-spin" *ngIf="submitProcessing"
                                        style="font-size:19px"></i></button>
                            </div>
                            <div class="col-md-6 pull-right" *ngIf="submitText == 'Save'">
                                <button type="button" id="btnComponentSave" (click)="clear()"
                                    class="button btn-warning btn-style" [disabled]="submitProcessing">
                                    Clear</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>