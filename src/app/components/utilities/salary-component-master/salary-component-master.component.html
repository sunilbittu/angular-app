<div class="container-fluid">
  <div class="d-flex align-items-center mt-2">
    <div class="m-2">
      <div class="h-size"><i class="fa fa-user"></i> <b> Salary Component Master</b></div>
    </div>
    <div class="flex-fill"></div>
  </div>
  <br>
  <ul class="nav nav-tabs" role="tablist">
    <li class="nav-item">
      <a class="active nav-link active" href="#earning" role="tab" data-toggle="tab"
        (click)="setType('EARNINGS')">Earning</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#deduction" role="tab" data-toggle="tab" (click)="setType('DEDUCTIONS')">Deduction</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#other" role="tab" data-toggle="tab" (click)="setType('OTHERS')">Other</a>
    </li>
  </ul>
  <!-- Tab panes -->
  <div class="tab-content">
    <div role="tabpanel" class="tab-pane active" id="earning">
      <table class="table table-striped table-bordered">
        <thead class="t-head">
          <tr>
            <th *ngFor="let head of salaryCompHeaders"><a>{{head}}</a></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="!toggleLoader">
            <td colspan="5">
              <img src="./assets/images/loader-icon.gif" class="loader-margin img-responsive" alt="loading....">
            </td>
          </tr>
          <tr *ngFor="let data of earningList">
            <td>{{data.salarycomponent | titlecase}}</td>
            <td>{{data.componentCode}}</td>
            <td>{{data.type}}</td>
            <td>{{data.formula}}</td>
            <td>{{data.description}}</td>
            <td class="action-width align-center">
              <a title="Edit" class="icon-margin edit" (click)="edit(data)"><i class="fas fa-user-edit"></i></a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div role="tabpanel" class="tab-pane fade block" id="deduction">
      <table class="table table-striped table-bordered">
        <thead class="t-head">
          <tr>
            <th *ngFor="let head of salaryCompHeaders"><a>{{head}}</a></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of deductionList">
            <td>{{data.salarycomponent | titlecase}}</td>
            <td>{{data.componentCode}}</td>
            <td>{{data.type}}</td>
            <td>{{data.formula}}</td>
            <td>{{data.description}}</td>
            <td class="action-width align-center">
              <a title="Edit" class="icon-margin edit" (click)="edit(data)"><i class="fas fa-user-edit"></i></a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div role="tabpanel" class="tab-pane fade block" id="other">
      <table class="table table-striped table-bordered">
        <thead class="t-head">
          <tr>
            <th *ngFor="let head of salaryCompHeaders"><a>{{head}}</a></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of otherList">
            <td>{{data.salarycomponent | titlecase}}</td>
            <td>{{data.componentCode}}</td>
            <td>{{data.type}}</td>
            <td>{{data.formula}}</td>
            <td>{{data.description}}</td>
            <td class="action-width align-center">
              <a title="Edit" class="icon-margin edit" (click)="edit(data)"><i class="fas fa-user-edit"></i></a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div>
      <div class="row m-2">
        <div class="col-12 p-0 pull-down-8">
          <button id="btn_add" type="button" data-toggle="modal" data-target="#add" class="button btn-primary button"
            (click)="addClick()"><i class="fas fa-user-plus"></i>
            Add</button>
          <button type="button" data-toggle="modal" data-target="#ctc_component" id="btn_ctc_component"
            style="float: right" class="button btn-primary button" (click)="showListCTC()">CTC
            Components</button>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade common-model" id="add">
  <div class="modal-dialog modal-md">
    <div class="modal-content model">
      <form [formGroup]="form" (ngSubmit)="saveSalaryComponent()">
        <!-- Modal Header -->
        <div class="modal-header">
          <div class="modal-title"><i class="fas fa-plus"></i>/ <i class="fas fa-edit ml-1"></i> Salary Component Master
          </div>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <!-- Modal body -->
        <div class="modal-body">
          <div class="row">
            <div class="col-md-12">
              <div class="pull-left-5">
                <table class="model-tbl">
                  <tr>
                    <td>
                      <label>Salary Component<span class="color-red">*</span></label>
                    </td>
                    <td>
                      <input type="text" class="form-control" formControlName="salarycomponent"
                        (ngModelChange)="checkComponent()"
                        [ngClass]="{ 'is-invalid': (submitted && form_.salarycomponent.errors) || isSalaryComponentAlreadyExist }">
                      <span class="color-red" *ngIf="submitted && form_.salarycomponent.errors">Salary component
                        {{requiredErrorText}}</span>
                      <span class="color-red" *ngIf="isSalaryComponentAlreadyExist">Salary component is already exist in
                        DB.</span>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <label>Component Code<span class="color-red">*</span></label>
                    </td>
                    <td><input type="text" class="form-control" formControlName="componentCode"
                        [ngClass]="{ 'is-invalid': submitted && form_.componentCode.errors }">
                      <span class="color-red" *ngIf="submitted && form_.componentCode.errors">Component Code
                        {{requiredErrorText}}</span>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <label>Type<span class="color-red">*</span></label>
                    </td>
                    <td><select class="custom-select-box form-control" (change)="changeType()" formControlName="type"
                        [ngClass]="{ 'is-invalid': submitted && form_.type.errors }"> 
                        <option value='fixed'>Fixed</option>
                        <option value='formula'>Formula</option>
                      </select>
                      <span class="color-red" *ngIf="submitted && form_.type.errors">Type
                        {{requiredErrorText}}</span>
                    </td>
                    <!-- <select class="custom-select-box form-control" [(ngModel)]="destinationBranch"
                                (change)="changeBranchDestination(destinationBranch)" formControlName="type">
                                <option value='' disabled>--Select Shift--</option>
                                <option *ngFor="let branch of shiftList" [ngValue]="branch">
                                    {{branch.name}}
                                </option>
                    </select> -->
                  </tr>
                  <tr *ngIf=formulaShow>
                    <td>
                      <label>Formula<span class="color-red">*</span></label>
                    </td>
                    <td><input type="text" class="form-control" formControlName="formula"
                        [ngClass]="{ 'is-invalid': submitted && form_.type.errors }">
                      <span class="color-red" *ngIf="submitted && form_.type.errors">Formula
                        {{requiredErrorText}}</span>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <label>Description</label>
                    </td>
                    <td><textarea id="txtformula" rows="3" class="form-control w-100"
                        formControlName="description"></textarea></td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </div>
        <!-- Modal footer -->
        <hr>
        <div class="row btn-footer">
          <div class="col-md-6 pull-left">
            <button type="submit" id="btnComponentSave" class="button btn-primary btn-style"
              [disabled]="submitProcessing"><i class="fas fa-save"></i>
              {{submitText}}</button>
          </div>
          <div class="col-md-6 pull-right" *ngIf="submitText == 'Save'">
            <button type="button" class="button btn-warning btn-style" (click)="resetTheForm()">Clear</button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="modal fade common-model" id="ctc_component" data-keyboard="false" data-backdrop="static">
  <div class="modal-dialog modal-xl">
    <div class="modal-content model">
      <!-- Modal Header -->
      <div class="modal-header">
        <div class="modal-title"><i class="fas fa-plus"></i>/ <i class="fas fa-edit ml-1"></i>CTC COMPONENTS</div>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <!-- Modal body -->
      <div class="modal-body">
        <div class="row" style="float: right">
          <!-- <div class="col-12" *ngIf="!showAddCTC">
            <button id="btn_add" type="button" class="button btn-primary button" (click)="showAddCtc()"><i
                class="fas fa-user-plus"></i> Add</button>
                <button id="btn_add" type="button" class="button btn-info" data-dismiss="modal"><i
                  class="fas fa-times"></i> Close</button>
          </div> -->
          <div class="m-2" *ngIf="showAddCTC">
            <button class="btn btn-default btn-sm back-btn" (click)="showListCTC()"> Back <i
                class="fas fa-long-arrow-alt-left"></i></button>
          </div>
        </div>
        <br><br>
        <div *ngIf="showAddCTC">
          <form [formGroup]="ctcForm" (ngSubmit)="submitCtcComponent()">
            <div class="row col-12 padding-field-bottom">
              <div class="col-2">
                <label>Component Scheme Name:<span class="color-red">* </span></label>
              </div>
              <div class="col-10">
                <input type="text" class="form-control" formControlName="componentname"
                  (ngModelChange)="checkCtcComponent()"
                  [ngClass]="{ 'is-invalid': (submitted1 && ctcform_.componentname.errors) || isCtcComponentAlreadyExist }">
                <span class="color-red" *ngIf="submitted1 && ctcform_.componentname.errors">Ctc component
                  {{requiredErrorText}}</span>
                <span class="color-red" *ngIf="isCtcComponentAlreadyExist">Ctc component is already exist in DB.</span>
              </div>
            </div>
            <div class="row col-12 margin-field">
              <div class="col-4 pb-0">
                <table class="table table-striped table-bordered">
                  <thead class="t-head">
                    <tr>
                      <th colspan="2">EARNINGS</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let data of earningList">
                      <td><input type="checkbox" class="status-check" [disabled]="data.isDisabled"
                          [checked]="data.selected" (change)="getEarningStatus(data.salaryComponentMasterId)"
                          name="status"></td>
                      <td>{{data.salarycomponent}}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="col-4 pb-0">
                <table class="table table-striped table-bordered">
                  <thead class="t-head">
                    <tr>
                      <th colspan="2">DEDUCTIONS</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let data of deductionList">
                      <td><input type="checkbox" class="status-check" [disabled]="data.isDisabled"
                          [checked]="data.selected" (change)="getDeductionStatus(data.salaryComponentMasterId)"
                          name="status"></td>
                      <td>{{data.salarycomponent}}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="col-4 pb-0">
                <table class="table table-striped table-bordered">
                  <thead class="t-head">
                    <tr>
                      <th colspan="2">OTHERS</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let data of otherList">
                      <td><input type="checkbox" class="status-check" [disabled]="data.isDisabled"
                          [checked]="data.selected" (change)="getOtherStatus(data.salaryComponentMasterId)"
                          name="status"></td>
                      <td>{{data.salarycomponent}}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <hr>
            <div class="row" *ngIf="ctcSubmitText != ''">
              <div class="col-md-6 pull-left">
                <button type="submit" id="btnComponentSave" class="button btn-primary btn-style"><i
                    class="fas fa-save"></i>
                  {{ctcSubmitText}}</button>
              </div>
            </div>
          </form>
        </div>
        <div class="row" *ngIf="!showAddCTC">
          <div class="col-md-12">
            <table class="table table-striped table-bordered">
              <thead class="t-head">
                <tr>
                  <th class="action-width align-center"><a>#</a></th>
                  <th *ngFor="let head of ctcHeaders"><a>{{head}}</a></th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let data of ctcComponentList; let i=index">
                  <td class="action-width align-center">{{i + 1}}</td>
                  <td>{{data.componentname}}</td>
                  <td class="action-width-tab">
                    <a title="View" class="icon-margin" (click)="viewCtc(data)"><i class="fa fa-eye"></i></a>&nbsp;
                    <a title="Edit" class="icon-margin edit" (click)="editCtc(data)"><i
                        class="fas fa-user-edit"></i></a>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="col-12 pull-down-8" *ngIf="!showAddCTC">
        <button id="btn_add" type="button" class="button btn-primary button" (click)="showAddCtc()"><i
            class="fas fa-user-plus"></i> Add</button>
      </div>
    </div>
  </div>
</div>